<thead>
    <tr>
        {#TODO Condense these 3 sections into 1 as they are very similar #}

        {% for tokenTag in tokenTags.pathTokens %}
            <th class="pathTokens" data-tokenname="{{ tokenTag.name }}">
                {% if tokenTag.tags %}
                    <select class="tag-selector" name="tokentag">
                            <option value=""></option>
                            {% for tag in tokenTag.tags %}
                                <option value="{{ tokenTag.name }}_{{ tag.id }}"{% ifequal tokenTag.tags|length 1 %} selected{% endifequal %}>{{ tag.name }}({{ tag.id }})</option>
                            {% endfor %}
                    </select>

                {% else %}
                <a class="token" href="">{{ tokenTag.name }}</a>
                {% endif %}
            </th>
        {% endfor %}

        {% for tokenTag in tokenTags.fileTokens %}
            <th class="fileTokens" data-tokenname="{{ tokenTag.name }}">
                {% if tokenTag.tags %}
                    <select class="tag-selector" name="tokentag">
                            <option value=""></option>
                            {% for tag in tokenTag.tags %}
                                <option value="{{ tokenTag.name }}_{{ tag.id }}"{% ifequal tokenTag.tags|length 1 %} selected{% endifequal %}>{{ tag.name }}({{ tag.id }})</option>
                            {% endfor %}
                    </select>
                    <div class="tag">
                        <a class="tooltip tag_inner" href="/webclient/usertags/?show=tag-51" target="_top">R3D</a>
                        <span class="showTag" id="51-tag" title="Remove Tag" url="/webclient/action/remove/tag/51/" style="display: none;">X</span>
                        <span class="tooltip_html" style="display: none;">
                            <b>Owner:</b> Douglas Russell<br>
                            <b>Linked by:</b> Douglas Russell<br>
                            <b>On:</b> 2013-08-22 23:19:34<br>
                            <b>Description:</b> 
                        </span>
                    </div>
                {% else %}
                <a class="token" href="">{{ tokenTag.name }}</a>
                {% endif %}

            <div style="position: relative">
                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="#">Action</a></li>
                    <li><a href="#">Another action</a></li>
                    <li><a href="#">Something else here</a></li>
                    <li class="divider"></li>
                    <li><a href="#">Separated link</a></li>
                </ul>
            </div>
            </th>
        {% endfor %}

        {% for tokenTag in tokenTags.extTokens %}
            <th class="extTokens" data-tokenname="{{ tokenTag.name }}">
                {% if tokenTag.tags %}
                    <select class="tag-selector" name="tokentag">
                            <option value=""></option>
                            {% for tag in tokenTag.tags %}
                                <option value="{{ tokenTag.name }}_{{ tag.id }}"{% ifequal tokenTag.tags|length 1 %} selected{% endifequal %}>{{ tag.name }}({{ tag.id }})</option>
                            {% endfor %}
                    </select>
                {% else %}
                <a class="token" href="">{{ tokenTag.name }}</a>
                {% endif %}
            </th>
        {% endfor %}

        <th>Image Name</th>
    </tr>
</thead>

<tbody>
    {% for imageDetail in imageDetails %}
        <tr id="image_{{ imageDetail.id }}" data-imageid="{{ imageDetail.id }}">
            {% for imageToken in imageDetail.tokens %}
                {# Display special case background color for server selected tokens #}
                <td class="{{ imageToken.tokenType }} token_{{ imageToken.name }}{% if imageToken.selected %} success{% endif %}">

                {% if imageToken.autoselect or imageToken.selected %}
                    <input class="imagechecked" name="imagechecked" value="{{ imageDetail.id }}_{{ imageToken.name }}" type="checkbox" checked />
                {% else %}
                    <input class="imagechecked" name="imagechecked" value="{{ imageDetail.id }}_{{ imageToken.name }}" type="checkbox" />
                {% endif %}

                {# Create a hidden field to indicate that for the current mapping, this image is tagged server side #}
                {% if imageToken.selected %}
                    <input class="serverselected" name="serverselected" type="hidden" value="{{ imageDetail.id }}_{{ imageToken.name }}"/>
                {% endif %}
                </td>
            {% endfor %}
            <td>
                {{ imageDetail.name }} ({{ imageDetail.id }})
                <!--<input name="image" type="hidden" value="{{ imageDetail.id }}" />-->
            </td>
        </tr>
    {% endfor %}
</tbody>
